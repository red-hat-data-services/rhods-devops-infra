# What?

A python script plus a container config, which allow extracting container IDs from a given Erratum ID and then scanning them with ClamAV inside a container. The results are stored in the ./results folder. The ./clamav folder is used as buffer for ClamAV definitions.

# Why?

Until the Malware Scanning workstream comes out with an automated and integrated way to scan containers for malware, I need a "semi-automated" approach for some of my offerings.

# How?

1. Prepare the environment using:

```bash
./first_run.sh
```

2. Then launch the python script, replacing ERRATUM_ID with an erratum number:

```bash
python3 main.py -e ERRATUM_ID
```

3. Check for results in the "./results" folder

Note: before every major scanning session and/or every week refresh the scanning container by running first_run.sh again. This assures ClamAV scanner is up to date.

Alternatively, you can use the "./scan_work_dir.sh" script to scan content of "./work" directory and produce results of that scan into "./results/work_dir_scan.result"
By default, "./work" directory contains so called EICAR testing file. You can use "./scan_work_dir.sh" together with the EICAR testing file to test that the scanner
is working. On successful run, the scanner will flag the EICAR file as INFECTED.

# Prerequisities

Python libraries, in case you want to use the python script:
    koji
    argparse
    errata_tool
    plumbum

Host system dependencies:
    clamav
    podman

